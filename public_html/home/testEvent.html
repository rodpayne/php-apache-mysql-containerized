<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Page Visibility API</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
var visibilityChange = (function (window) {
var inView = false;
return function (fn) {
	window.onfocus = window.onblur = window.onpageshow = window.onpagehide = function (e) {
		if ({focus:1, pageshow:1}[e.type]) {
			if (inView) return;
			fn("visible");
			inView = true;
		} else if (inView) {
			fn("hidden");
			inView = false;
		}
	};
};
}(this));
visibilityChange(function (state) {
var d = new Date();
var n = d.toLocaleTimeString();
document.getElementById("textoutput").innerHTML= n +': Page is ' + state + '<br />'+ document.getElementById("textoutput").innerHTML;
if (state=="hidden")
{
	$("#message").fadeIn();
	document.title = "Come Back!";
}
if (state=="visible")
{
	$("#message").fadeOut(2000);
	document.title = "Page Visibility API";
}
});
</script>
<style>
#message {
	display: none;
}
.body-flex-container { display: flex; width: 100%; height: 100%; flex-direction: column; overflow: hidden; }
.content-flex-row { 
	flex-grow: 1; 
	margin: 0; 
	margin-top: env(safe-area-inset-top);
	margin-right: env(safe-area-inset-right);
	margin-bottom: env(safe-area-inset-bottom);
	margin-left: env(safe-area-inset-left);
	padding: 0; 
	border: 1px solid blue;
	width: 100%; height: 100%;	
}
</style>
</head>
<body>
	<div class="body-flex-container">
		<div class="content-flex-row" >
			<h1>Page Visibility API</h1>
			<div id="message"><h2>You’ve been away, haven’t you!</h2></div>
			<div id="textoutput"></div>
		</div>
	</div>
</body>
</html>
